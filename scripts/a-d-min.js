(function(){var g="cellSize",s="gridWidth",E="grid",L="canvas",C="click",f="img",H="moves",D="image/png",J=document,A="createElement",z=J[A](L),k=100,l=k/3,p=l*2,h=k/2,x=[[J[A](f),[l,l],[p,l],[h,p]],[J[A](f),[p,l],[p,p],[l,h]],[J[A](f),[l,p],[p,p],[h,l]],[J[A](f),[l,l],[l,p],[p,h]]],q,N,w=undefined,K="apply",n="getContext",m=256,r=Math,o="length",I="_controlButtons",j,F,M,t,b,y,O,e,i,v,a,G,u;if(!z[n]){throw"This browser does not support the use of canvas"}z.width=z.height=k;q=z[n]("2d");q.fillStyle="#888";q.strokeRect(0,0,k,k);for(N=0;N<4;N++){q.clearRect(1,1,k-2,k-2);q.beginPath();q.moveTo(x[N][1][0],x[N][1][1]);q.lineTo(x[N][2][0],x[N][2][1]);q.lineTo(x[N][3][0],x[N][3][1]);q.fill();x[N][0].src=z.toDataURL(D).replace(D,"image/octet-stream")}j=function(R,d){var Q,P,c;if(R.tagName!="DIV"){Q=B.create("div");R.parentNode.replaceChild(Q,R);R=Q}this.parent=R;d=d||{};P=d.size||300;c=B.create(L,{width:P,height:P},this.parent);this.ctx=c[n]("2d");this[I]=[],F[K](this,[d.nbCellsSide||4,d.nbColors||4])};M=function(){this.infos={blobs:["Blobs",0],moves:[H,0],colors:["Colors",this.colors.length]};Object.keys(this.infos).forEach(function(c){this.infos[c][1]=B.create("span",{text:this.infos[c][1]},B.create("div",{text:this.infos[c][0]+": "},this.parent))}.bind(this))};t=function(c){return this.infos[c]?0|this.infos[c][1].innerHTML:false};b=function(d,c){if(!this.infos[d]){return false}this.infos[d][1].innerHTML=c};F=function(d,c){O[K](this,[c]);e[K](this,[d,c]);i[K](this,[true]);M[K](this);u[K](this);G[K](this)};y=function(c){return 0|r.random()*c};O=function(P){var R=[],U,S=P-1,d,T,Q;T=function(){return[y(m),y(m),y(m)]};Q=function(W,V,c){return 0|(r.min(W,V)+r.abs(W-V)*c)};R[0]=T();R[S]=[];for(U=0;U<3;U++){R[S].push((R[0][U]+128)%m)}for(U=1;U<S;U++){d=U/S;R[U]=[Q(R[0][0],R[S][0],d),Q(R[0][2],R[S][1],d),Q(R[0][1],R[S][2],d)]}this.colors=R;this.nbColors=R[o]};e=function(P,d){var c,Q;this[E]=[];this[s]=P;for(c=0;c<P;c++){this[E][c]=[];for(Q=0;Q<P;Q++){this[E][c][Q]=y(d)}}};i=function(R){var d=this.ctx.canvas.clientWidth,c,S,Q,P;this[g]=d/(this[s]+2);Q=function(T,V){var U=this.colors[this[E][T][V]];this.ctx.fillStyle="rgb("+U+")";this.ctx.fillRect((T+1)*this[g],(V+1)*this[g],this[g],this[g])};P=function(W,V,T,X,U){for(X=0;X<T[o];X++){this[I].push([W,V]);this.ctx.drawImage(x[T[X]][0],W,V,this[g],this[g]);U=W;W=V;V=U}};for(c=0;c<this[s];c++){if(R){P[K](this,[(c+1)*this[g],0,[0,3]]);P[K](this,[d-this[g],(c+1)*this[g],[1,2]])}for(S=0;S<this[s];S++){Q[K](this,[c,S])}}};a=function(P,Q){var d,c=this._controlButtons.length;for(d=0;d<c;d++){if(this._controlButtons[d][0]<=P&&P<=this._controlButtons[d][0]+this[g]&&this._controlButtons[d][1]<=Q&&Q<=this._controlButtons[d][1]+this[g]){break}}return d==c?null:d};v=function(R){var S=this.ctx.canvas.getBoundingClientRect(),Q=a[K](this,[R.clientX-S.left,R.clientY-S.top]),P,c,U,d,V,T;if(Q==null){return}P=function(W){var X=this[E][W][this[E][W].length-1];this[E][W].pop();this[E][W].unshift(X)};c=function(aa){var X,W=-1,Z,Y=this[E].length-1;for(Z in this[E]){X=this[E][Z][aa];this[E][Z][aa]=~W?W:this[E][(Z+Y)%this[E].length][aa];W=X}};d=function(W){var X=this[E][W][0];this[E][W].shift();this[E][W].push(X)};U=function(Y){var W,X=this[E][0][Y];for(W=0;W<this[s];W++){this[E][W][Y]=this[E][(0|W+1)%this[E].length][Y]}this[E][this[E].length-1][Y]=X};V=0|Q/4;switch(Q%4){case 0:P[K](this,[V]);break;case 1:c[K](this,[V]);break;case 2:U[K](this,[V]);break;case 3:d[K](this,[V]);break}T=u.apply(this);b.apply(this,[H,0|t.apply(this,[H])+1]);i.apply(this,[false]);if(T==this.nbColors){B.off(this.parent,C,v.bind(this))}};G=function(){B.on(this.parent,C,v.bind(this))};u=function(){var S,R=0,c,Q,d=this[s]*this[s],P;S=new Array(d);P=function(aa,Z,T){var V=this[E][aa][Z],X=Z*this[s]+aa,U=X-this[s],W=X+this[s],Y=X+1,ab=X-1;S[X]=T;if(U>0&&S[U]==w&&this[E][aa][Z-1]==V){P[K](this,[aa,Z-1,T])}if(Y%this[s]>X%this[s]&&S[Y]==w&&this[E][aa+1][Z]==V){P[K](this,[aa+1,Z,T])}if(W<d&&S[W]==w&&this[E][aa][Z+1]==V){P[K](this,[aa,Z+1,T])}if(r.abs(ab%this[s])<X%this[s]&&S[ab]==w&&this[E][aa-1][Z]==V){P[K](this,[aa-1,Z,T])}};for(c=0;c<this[s];c++){for(Q=0;Q<this[s];Q++){if(S[Q*this[s]+c]!=w){continue}P[K](this,[c,Q,R]);R++}}b[K](this,["blobs",R]);return R};window.Ad=j})();