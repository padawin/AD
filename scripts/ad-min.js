(function(){var v=document,r="createElement",i=v[r]("canvas"),o=100,k=o/3,e=k*2,t=o/2,n=[[v[r]("img"),[k,k],[e,k],[t,e]],[v[r]("img"),[e,k],[e,e],[k,t]],[v[r]("img"),[k,e],[e,e],[t,k]],[v[r]("img"),[k,k],[k,e],[e,t]]],s,x,b=undefined,g="cellSize",u="gridWidth",a="grid",w,m,l,p,q,f,h,j;if(!i.getContext){throw"This browser does not support the use of canvas"}i.width=i.height=o;s=i.getContext("2d");s.fillStyle="#888";s.strokeRect(0,0,o,o);for(x=0;x<4;x++){s.clearRect(1,1,o-2,o-2);s.beginPath();s.moveTo(n[x][1][0],n[x][1][1]);s.lineTo(n[x][2][0],n[x][2][1]);s.lineTo(n[x][3][0],n[x][3][1]);s.fill();n[x][0].src=i.toDataURL("image/png").replace("image/png","image/octet-stream")}w=function(c){if(c.tagName!="CANVAS"){throw"The parent element must be a canvas tag"}this.parent=c;this.ctx=this.parent.getContext("2d");this._controlButtons=[],m.apply(this,[4,4])};m=function(d,c){p.apply(this,[c]);q.apply(this,[d,c]);f.apply(this,[true]);this._nbBlobs=j.apply(this);h.apply(this)};l=function(c){return 0|Math.random()*c};p=function(y){var A=[],E,C=y-1,d,D,z;D=function(){return[l(256),l(256),l(256)]};z=function(G,F,c){return 0|(Math.min(G,F)+Math.abs(G-F)*c)};A[0]=D();A[C]=[];for(E=0;E<3;E++){A[C].push((A[0][E]+128)%256)}for(E=1;E<C;E++){d=E/C;A[E]=[z(A[0][0],A[C][0],d),z(A[0][2],A[C][1],d),z(A[0][1],A[C][2],d)]}this.colors=A;this.nbColors=A.length};q=function(z,d){var c,A;this[a]=[];this[u]=z;for(c=0;c<z;c++){this[a][c]=[];for(A=0;A<z;A++){this[a][c][A]=l(d)}}};f=function(C){var d=this.ctx.canvas.clientWidth,c,D,A,z;this[g]=d/(this[u]+2);A=function(E,G){var F=this.colors[this[a][E][G]];this.ctx.fillStyle="rgb("+F[0]+","+F[1]+","+F[2]+")";this.ctx.fillRect((E+1)*this[g],(G+1)*this[g],this[g],this[g])};z=function(G,F,y,H,E){for(H=0;H<y.length;H++){this._controlButtons.push([G,F]);this.ctx.drawImage(n[y[H]][0],G,F,this[g],this[g]);E=G;G=F;F=E}};for(c=0;c<this[u];c++){if(C){z.apply(this,[(c+1)*this[g],0,[0,3]]);z.apply(this,[d-this[g],(c+1)*this[g],[1,2]])}for(D=0;D<this[u];D++){A.apply(this,[c,D])}}};h=function(){var c=function(A,C){var z,d=this._controlButtons.length;for(z=0;z<d;z++){if(this._controlButtons[z][0]<=A&&A<=this._controlButtons[z][0]+this[g]&&this._controlButtons[z][1]<=C&&C<=this._controlButtons[z][1]+this[g]){break}}return z==d?null:z};B.addEvent(this.parent,"click",function(C){var z=c.apply(this,[C.layerX,C.layerY]),y,d,E,A,D;if(z==null){return}y=function(F){var G=this[a][F][this[a][F].length-1];this[a][F].pop();this[a][F].unshift(G)};d=function(J){var G,F=-1,I,H=this[a].length-1;for(I in this[a]){G=this[a][I][J];this[a][I][J]=~F?F:this[a][(I+H)%this[a].length][J];F=G}};A=function(F){var G=this[a][F][0];this[a][F].shift();this[a][F].push(G)};E=function(H){var F,G=this[a][0][H];for(F=0;F<this[u];F++){this[a][F][H]=this[a][(parseInt(F)+1)%this[a].length][H]}this[a][this[a].length-1][H]=G};D=0|z/4;switch(z%4){case 0:y.apply(this,[D]);break;case 1:d.apply(this,[D]);break;case 2:E.apply(this,[D]);break;case 3:A.apply(this,[D]);break}this._nbBlobs=j.apply(this);f.apply(this,[false]);if(this._nbBlobs==this.nbColors){}}.bind(this))};j=function(){var D,C=0,c,A,d=this[u]*this[u],z;D=new Array(d);z=function(L,K,E){var G=this[a][L][K],I=K*this[u]+L,F=I-this[u],H=I+this[u],J=I+1,M=I-1;D[I]=E;if(F>0&&D[F]==b&&this[a][L][K-1]==G){z.apply(this,[L,K-1,E])}if(J%this[u]>I%this[u]&&D[J]==b&&this[a][L+1][K]==G){z.apply(this,[L+1,K,E])}if(H<d&&D[H]==b&&this[a][L][K+1]==G){z.apply(this,[L,K+1,E])}if(Math.abs(M%this[u])<I%this[u]&&D[M]==b&&this[a][L-1][K]==G){z.apply(this,[L-1,K,E])}};for(c=0;c<this[u];c++){for(A=0;A<this[u];A++){if(D[A*this[u]+c]!=b){continue}z.apply(this,[c,A,C]);C++}}return C};window.Ad=w})();